# Лабораторна робота №9-10: Дослідження методів ансамблевого навчання

## Опис
Дослідження методів ансамблів у машинному навчанні з використанням спеціалізованих бібліотек та мови програмування Python.

## Встановлення залежностей

```bash
pip install -r requirements.txt
```

## Структура проекту

```
lab9-10/
├── !materials/              # Вхідні дані
│   ├── data_random_forests.txt
│   ├── data_imbalance.txt
│   └── traffic_data.txt
├── utilities.py             # Допоміжні функції візуалізації
├── LR_9_task_1.py          # Завдання 9.1: Випадкові та гранично випадкові ліси
├── LR_9_task_2.py          # Завдання 9.2: Обробка дисбалансу класів
├── LR_10_task_1.py         # Завдання 10.1: Сітковий пошук параметрів
├── LR_10_task_2.py         # Завдання 10.2: Важливість ознак
├── LR_10_task_3.py         # Завдання 10.3: Прогнозування трафіку
└── requirements.txt        # Залежності проекту
```

## Завдання Лабораторної роботи №9

### Завдання 9.1: Створення класифікаторів на основі випадкових та гранично випадкових лісів

**Виконання з випадковим лісом (Random Forest):**
```bash
python LR_9_task_1.py --classifier-type rf
```

**Виконання з гранично випадковим лісом (Extremely Random Forest):**
```bash
python LR_9_task_1.py --classifier-type erf
```

**Що робить програма:**
- Завантажує дані з файлу `data_random_forests.txt` (3 класи)
- Візуалізує вхідні дані
- Розбиває дані на навчальну та тестову вибірки (75%/25%)
- Навчає класифікатор (RF або ERF)
- Візуалізує границі класифікації
- Виводить метрики якості (precision, recall, f1-score)
- Обчислює рівні довірливості для тестових точок

**Очікувані результати:**
- Графік вхідних даних з трьома класами
- Візуалізація границь класифікації для навчальної вибірки
- Візуалізація границь класифікації для тестової вибірки
- Звіт про якість класифікації
- Рівні довірливості для тестових точок

### Завдання 9.2: Обробка дисбалансу класів

**Виконання без балансування:**
```bash
python LR_9_task_2.py
```

**Виконання з балансуванням класів:**
```bash
python LR_9_task_2.py balance
```

**Що робить програма:**
- Завантажує дані з файлу `data_imbalance.txt` (2 класи з дисбалансом)
- Візуалізує вхідні дані
- Навчає ExtraTreesClassifier з/без балансування класів
- Показує вплив дисбалансу на якість класифікації

**Очікувані результати:**
- Порівняння якості класифікації з балансуванням і без
- Покращення метрик для меншого класу при балансуванні

## Завдання Лабораторної роботи №10

### Завдання 10.1: Знаходження оптимальних навчальних параметрів

**Виконання:**
```bash
python LR_10_task_1.py
```

**Що робить програма:**
- Використовує сітковий пошук (GridSearchCV)
- Перебирає комбінації параметрів:
  - `n_estimators`: [25, 50, 100, 250]
  - `max_depth`: [2, 4, 7, 12, 16]
- Оптимізує за двома метриками: precision і recall
- Виводить найкращі комбінації параметрів

**Очікувані результати:**
- Оцінки для всіх комбінацій параметрів
- Найкращі параметри для precision
- Найкращі параметри для recall
- Звіт про якість на тестовій вибірці

### Завдання 10.2: Обчислення відносної важливості ознак

**Виконання:**
```bash
python LR_10_task_2.py
```

**Що робить програма:**
- Використовує датасет Boston Housing
- Навчає AdaBoost регресор
- Обчислює важливість кожної ознаки
- Будує стовпчасту діаграму важливості

**Очікувані результати:**
- Mean Squared Error (MSE)
- Explained Variance Score
- Діаграма важливості ознак
- Висновки про найбільш і найменш важливі ознаки

### Завдання 10.3: Прогнозування інтенсивності дорожнього руху

**Виконання:**
```bash
python LR_10_task_3.py
```

**Що робить програма:**
- Завантажує дані про трафік біля стадіону Доджер-стедіум
- Кодує категоріальні ознаки (день тижня, час, команда, наявність матчу)
- Навчає ExtraTreesRegressor
- Прогнозує інтенсивність руху для нових даних

**Очікувані результати:**
- Mean Absolute Error на тестовій вибірці
- Прогнози для тестових випадків
- Демонстрація роботи кодування ознак

## Примітки

1. **Попередження sklearn:** У деяких версіях sklearn можуть з'являтися попередження про deprecated функції. Код адаптовано для роботи з різними версіями.

2. **Візуалізація:** Всі графіки відкриваються послідовно. Закрийте поточне вікно, щоб перейти до наступного.

3. **Boston Housing dataset:** У новіших версіях sklearn цей датасет може бути deprecated. Якщо виникне помилка, можна замінити на інший датасет або завантажити дані окремо.

4. **Traffic data:** Файл містить близько 17569 рядків даних про трафік.

## Додаткова інформація

### Параметри класифікаторів:
- `n_estimators`: кількість дерев у лісі
- `max_depth`: максимальна глибина дерева
- `random_state`: seed для відтворюваності результатів
- `class_weight='balanced'`: автоматичне балансування класів

### Метрики якості:
- **Precision**: точність (скільки з передбачених позитивних є справді позитивними)
- **Recall**: повнота (скільки справжніх позитивних було знайдено)
- **F1-score**: гармонійне середнє precision і recall
- **Support**: кількість зразків у класі

## Troubleshooting

### Помилка: ModuleNotFoundError
```bash
pip install -r requirements.txt
```

### Помилка: "boston dataset is deprecated"
У `LR_10_task_2.py` замініть:
```python
housing_data = datasets.load_boston()
```
на:
```python
from sklearn.datasets import fetch_california_housing
housing_data = fetch_california_housing()
```

### Графіки не відображаються
Переконайтеся, що у вас встановлено графічний backend для matplotlib.

## Автор
Лабораторна робота №9-10
Курс: Штучний інтелект

